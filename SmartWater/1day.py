import pandas as pd
import numpy as np
alladd = [218521800500, 218521800501, 218521800502, 218521800503, 218521800504, 218521800505, 218521800506, 218521800414, 218521800415, 218521800416, 218521800417, 218521800418, 218521800419, 218521800420, 218521800421, 218521800422, 218521800423, 218521800424, 218521800425, 218521800426, 218521800427, 218521800428, 218521800429, 218521800430, 218521800431, 218521800432, 218521800433, 218521800434, 218521800435, 218521800436, 218521800444, 218521800445, 218521800446, 218521800447, 218521800448, 218521800449, 218521800450, 218521800451, 218521800452, 218521800453, 218521800454, 218521800455, 218521800456, 218521800457, 218521800458, 218521800459, 218521800460, 218521800461, 218521800462, 218521800463, 218521800464, 218521800465, 218521800466, 218521800467, 218521800468, 218521800469, 218521800470, 218521800471, 218521800472, 218521800473, 218521800474, 218521800475, 218521800476, 218521800477, 218521800478, 218521800479, 218521800480, 218521800481, 218521800482, 218521800483, 218521800484, 218521800485, 218521800486, 218521800487, 218521800488, 218521800489, 218521800490, 218521800491, 218521800492, 218521800493, 218521800494, 218521800495, 218521800496, 218521800497, 218521800498, 218521800499, 218521800507, 218521800508, 218521800509, 218521800510, 218521800511, 218521800512, 218521800513, 218521800514, 218521800515, 218521800516, 218521800517, 218521800518, 218521800519, 218521800291, 218521800322, 218521800323, 218521800324, 218521800325, 218521800326, 218521800327, 218521800328, 218521800329, 218521800330, 218521800331, 218521800332, 218521800333, 218521800334, 218521800335, 218521800336, 218521800337, 218521800338, 218521800339, 218521800340, 218521800341, 218521800342, 218521800343, 218521800344, 218521800345, 218521800346, 218521800347, 218521800348, 218521800349, 218521800350, 218521800351, 218521800352, 218521800353, 218521800354, 218521800355, 218521800356, 218521800357, 218521800358, 218521800359, 218521800360, 218521800361, 218521800362, 218521800363, 218521800364, 218521800365, 218521800366, 218521800367, 218521800368, 218521800369, 218521800370, 218521800371, 218521800372, 218521800373, 218521800374, 218521800375, 218521800376, 218521800377, 218521800378, 218521800379, 218521800380, 218521800381, 218521800382, 218521800383, 218521800384, 218521800385, 218521800386, 218521800387, 218521800388, 218521800389, 218521800390, 218521800391, 218521800392, 218521800393, 218521800394, 218521800395, 218521800396, 218521800397, 218521800398, 218521800399, 218521800400, 218521800401, 218521800402, 218521800403, 218521800404, 218521800405, 218521800406, 218521800407, 218521800408, 218521800409, 218521800410, 218521800411, 218521800412, 218521800413, 218521800437, 218521800438, 218521800439, 218521800440, 218521800441, 218521800442, 218521800443, 218521800201, 218521800202, 218521800203, 218521800204, 218521800205, 218521800206, 218521800207, 218521800208, 218521800229, 218521800230, 218521800231, 218521800232, 218521800233, 218521800234, 218521800235, 218521800236, 218521800237, 218521800238, 218521800239, 218521800240, 218521800241, 218521800242, 218521800243, 218521800244, 218521800245, 218521800246, 218521800247, 218521800248, 218521800249, 218521800250, 218521800251, 218521800252, 218521800253, 218521800254, 218521800255, 218521800256, 218521800257, 218521800258, 218521800259, 218521800260, 218521800261, 218521800262, 218521800263, 218521800264, 218521800265, 218521800266, 218521800267, 218521800268, 218521800269, 218521800270, 218521800271, 218521800272, 218521800273, 218521800274, 218521800275, 218521800276, 218521800277, 218521800278, 218521800279, 218521800280, 218521800281, 218521800282, 218521800283, 218521800284, 218521800285, 218521800286, 218521800287, 218521800288, 218521800289, 218521800290, 218521800292, 218521800293, 218521800294, 218521800295, 218521800296, 218521800297, 218521800298, 218521800299, 218521800300, 218521800301, 218521800302, 218521800303, 218521800304, 218521800305, 218521800306, 218521800307, 218521800308, 218521800309, 218521800310, 218521800311, 218521800312, 218521800313, 218521800314, 218521800315, 218521800316, 218521800317, 218521800318, 218521800319, 218521800320, 218521800321, 218521800116, 218521800117, 218521800118, 218521800119, 218521800120, 218521800121, 218521800122, 218521800123, 218521800124, 218521800125, 218521800126, 218521800127, 218521800128, 218521800129, 218521800130, 218521800131, 218521800132, 218521800133, 218521800134, 218521800135, 218521800136, 218521800137, 218521800138, 218521800144, 218521800145, 218521800146, 218521800147, 218521800148, 218521800149, 218521800150, 218521800151, 218521800152, 218521800153, 218521800154, 218521800155, 218521800156, 218521800157, 218521800158, 218521800159, 218521800160, 218521800161, 218521800162, 218521800163, 218521800164, 218521800165, 218521800166, 218521800167, 218521800168, 218521800169, 218521800170, 218521800171, 218521800172, 218521800173, 218521800174, 218521800175, 218521800176, 218521800177, 218521800178, 218521800179, 218521800180, 218521800181, 218521800182, 218521800183, 218521800184, 218521800185, 218521800186, 218521800187, 218521800188, 218521800189, 218521800190, 218521800191, 218521800192, 218521800193, 218521800194, 218521800195, 218521800196, 218521800197, 218521800198, 218521800199, 218521800200, 218521800209, 218521800210, 218521800211, 218521800212, 218521800213, 218521800214, 218521800215, 218521800216, 218521800217, 218521800218, 218521800219, 218521800220, 218521800221, 218521800222, 218521800223, 218521800224, 218521800225, 218521800226, 218521800227, 218521800228, 218521800004, 218521800005, 218521800006, 218521800007, 218521800008, 218521800009, 218521800010, 218521800011, 218521800012, 218521800013, 218521800014, 218521800032, 218521800033, 218521800034, 218521800035, 218521800036, 218521800037, 218521800038, 218521800039, 218521800040, 218521800041, 218521800042, 218521800043, 218521800044, 218521800045, 218521800046, 218521800047, 218521800048, 218521800049, 218521800050, 218521800051, 218521800052, 218521800053, 218521800054, 218521800055, 218521800056, 218521800057, 218521800058, 218521800059, 218521800060, 218521800061, 218521800062, 218521800063, 218521800064, 218521800065, 218521800066, 218521800067, 218521800068, 218521800069, 218521800070, 218521800071, 218521800072, 218521800073, 218521800074, 218521800075, 218521800076, 218521800077, 218521800078, 218521800079, 218521800080, 218521800081, 218521800082, 218521800083, 218521800084, 218521800085, 218521800086, 218521800087, 218521800088, 218521800089, 218521800090, 218521800091, 218521800092, 218521800093, 218521800094, 218521800095, 218521800096, 218521800097, 218521800098, 218521800099, 218521800100, 218521800101, 218521800102, 218521800103, 218521800104, 218521800105, 218521800106, 218521800107, 218521800108, 218521800109, 218521800110, 218521800111, 218521800112, 218521800113, 218521800114, 218521800115, 218521800139, 218521800140, 218521800141, 218521800142, 218521800143, 218521800002, 218521800003, 218521800015, 218521800016, 218521800017, 218521800018, 218521800019, 218521800020, 218521800021, 218521800022, 218521800023, 218521800024, 218521800025, 218521800026, 218521800027, 218521800028, 218521800029, 218521800030, 218521800031, 218520800595, 218520800596, 218520800520, 218520800521, 218520800523, 218520800524, 218520800537, 218520800538, 218520800539, 218520800540, 218520800541, 218520800542, 218520800543, 218520800544, 218520800545, 218520800546, 218520800547, 218520800548, 218520800549, 218520800550, 218520800551, 218520800552, 218520800553, 218520800554, 218520800555, 218520800556, 218520800557, 218520800558, 218520800559, 218520800560, 218520800561, 218520800562, 218520800563, 218520800564, 218520800565, 218520800566, 218520800567, 218520800568, 218520800569, 218520800570, 218520800571, 218520800572, 218520800573, 218520800574, 218520800575, 218520800576, 218520800577, 218520800578, 218520800579, 218520800581, 218520800582, 218520800583, 218520800584, 218520800585, 218520800586, 218520800587, 218520800588, 218520800589, 218520800590, 218520800591, 218520800592, 218520800593, 218520800594, 218520800525, 218520800526, 218520800527, 218520800528, 218520800529, 218520800530, 218520800531, 218520800532, 218520800533, 218520800534, 218520800535, 218520800536, 218510800186, 218510800187, 218510800188, 218510800189, 218510800190, 218510800191, 218510800097, 218510800098, 218510800099, 218510800100, 218510800101, 218510800102, 218510800103, 218510800104, 218510800105, 218510800106, 218510800107, 218510800108, 218510800109, 218510800110, 218510800111, 218510800112, 218510800113, 218510800114, 218510800115, 218510800126, 218510800127, 218510800128, 218510800129, 218510800130, 218510800131, 218510800132, 218510800133, 218510800134, 218510800135, 218510800136, 218510800137, 218510800138, 218510800139, 218510800140, 218510800141, 218510800142, 218510800143, 218510800144, 218510800145, 218510800146, 218510800147, 218510800148, 218510800149, 218510800150, 218510800151, 218510800152, 218510800153, 218510800154, 218510800155, 218510800156, 218510800157, 218510800158, 218510800159, 218510800160, 218510800161, 218510800162, 218510800163, 218510800164, 218510800165, 218510800166, 218510800167, 218510800168, 218510800169, 218510800170, 218510800171, 218510800172, 218510800173, 218510800174, 218510800175, 218510800176, 218510800177, 218510800178, 218510800179, 218510800180, 218510800182, 218510800183, 218510800184, 218510800185, 218510800007, 218510800008, 218510800009, 218510800010, 218510800011, 218510800012, 218510800013, 218510800014, 218510800015, 218510800016, 218510800017, 218510800018, 218510800019, 218510800020, 218510800021, 218510800022, 218510800023, 218510800024, 218510800027, 218510800028, 218510800029, 218510800030, 218510800031, 218510800032, 218510800033, 218510800034, 218510800035, 218510800036, 218510800037, 218510800038, 218510800039, 218510800040, 218510800041, 218510800042, 218510800043, 218510800044, 218510800045, 218510800046, 218510800047, 218510800048, 218510800049, 218510800050, 218510800051, 218510800052, 218510800053, 218510800056, 218510800057, 218510800058, 218510800059, 218510800060, 218510800061, 218510800062, 218510800063, 218510800064, 218510800065, 218510800066, 218510800067, 218510800068, 218510800069, 218510800070, 218510800071, 218510800072, 218510800073, 218510800074, 218510800075, 218510800076, 218510800077, 218510800078, 218510800079, 218510800080, 218510800081, 218510800082, 218510800083, 218510800084, 218510800085, 218510800086, 218510800087, 218510800088, 218510800089, 218510800090, 218510800091, 218510800092, 218510800093, 218510800094, 218510800095, 218510800096, 218510800116, 218510800117, 218510800118, 218510800119, 218510800120, 218510800121, 218510800122, 218510800123, 218510800124, 218510800125, 218510800003, 218510800004, 218510800005, 218510800006]
nn = 0
for data in alladd:
    csvn = "new_"+str(data)+".csv"
    df = pd.read_csv(csvn)
    time = df["rcvtime"]
    value = df["value_c"]
    t = 2
    lastv = value[0]
    v = []
    for i in range(len(time)):
        stime = str(time[i])
        itime = int(stime[5]+stime[6])
        sday = stime[4]
        
        if itime == t:
            t = t+1
        
            if value[i]>=lastv:
                #print(value[i]-lastv)
                v.append(value[i]-lastv)
            lastv = value[i+1]
        if t == 31 and sday == "4":
            t = 1
        elif t == 32:
            t = 1
        
    #print(len(v))
    if len(v) == 91:
        nn = nn+1
        average = sum(v)/len(v)
        #print("平均值:",average)
        n = 0
        for i in v:
            if i <= average+(average*0.1) and i >= average-(average*0.1):
                n = n+1
        svn = str(data)
        print("表號:",svn)
        print("符合天數:",n)
        #if n>=20:
            #print(csvn)
        
print(nn)
